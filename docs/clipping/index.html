<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>dvisvgm: Intersection of clipping paths</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="alternate" type="application/rss+xml" href="https://mgieseki.github.io/dvisvgm/index.xml" title="News about the DVI to SVG converter dvisvgm.">
    <!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/libs/html5shiv/3.7.2/html5shiv.js"></script>
<script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->

<link rel="stylesheet" href="https://mgieseki.github.io/dvisvgm/css/bootstrap.min.css">
<link rel="stylesheet" href="https://mgieseki.github.io/dvisvgm/css/fork-awesome.min.css">
<link rel="stylesheet" href="https://mgieseki.github.io/dvisvgm/css/style.css">
<link rel="stylesheet" href="https://mgieseki.github.io/dvisvgm/css/ekko-lightbox.css">
  </head>
  <body>
    <header id="main-header" class="page-header">
      <nav class="navbar navbar-expand-md fixed-top navbar-dark bg-primary">
   <div class="container">
      <a class="navbar-brand" href="https://mgieseki.github.io/dvisvgm">
         <i class="fa fa-home"></i> dvisvgm</a>
      <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
         <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarNav">
         <ul class="navbar-nav mr-auto">
            <li class="nav-item ">
               <a class="nav-link" href="/dvisvgm/News/" >News</a>
            </li>
            <li class="nav-item ">
               <a class="nav-link" href="/dvisvgm/Downloads/" >Downloads</a>
            </li>
            <li class="nav-item  dropdown">
               <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"> Documentation<span class="caret"></span></a>
               <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                  <a class="dropdown-item " href="/dvisvgm/Manpage/"><i class="fa fa-book fa-fw"></i> Manual Page</a>
                  <a class="dropdown-item " href="/dvisvgm/FAQ/"><i class="fa fa-question-circle fa-fw"></i> Frequently Asked Questions</a>
                  <a class="dropdown-item " href="/dvisvgm/Examples/"><i class="fa fa-image fa-fw"></i> SVG Examples</a>
                  <a class="dropdown-item " href="/dvisvgm/Screenshots/"><i class="fa fa-camera fa-fw"></i> Screenshots</a>
                  <a class="dropdown-item " href="/dvisvgm/Links/"><i class="fa fa-external-link fa-fw"></i> Related Projects</a>
                  </div>
            </li>
            <li class="nav-item ">
               <a class="nav-link" href="/dvisvgm/Contact/" >Contact</a>
            </li>
            <li class="nav-item  dropdown">
               <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"> Development<span class="caret"></span></a>
               <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                  <a class="dropdown-item " href="https://github.com/mgieseki/dvisvgm"><i class='fa fa-github fa-fw'></i> GitHub</a>
                  <a class="dropdown-item " href="https://travis-ci.org/mgieseki/dvisvgm"><i class='fa fa-gears fa-fw'></i> Travis CI builds</a>
                  <a class="dropdown-item " href="https://scan.coverity.com/projects/1099"><i class='fa fa-check-circle fa-fw'></i> Coverity Code Analysis</a>
                  <a class="dropdown-item " href="https://www.openhub.net/p/dvisvgm"><i class='fa fa-pie-chart fa-fw'></i> OpenHub Code Statistics</a>
                  <a class="dropdown-item " href="https://sourceforge.net/projects/dvisvgm"><i class='fa fa-database fa-fw'></i> SourceForge</a>
                  </div>
            </li>
         </ul>
      </div>
   </div>
</nav>
<div class="jumbotron text-primary" style="padding-top:10px;padding-bottom:5px">
   <div class="container">
      <h2>Intersection of clipping paths</h2>
      <h4>How to avoid rendering issues related to clipping path intersections</h4>
   </div>
</div>
</header>
    <main>
      <div class="container">
        
<p>In order to restrict the area where drawing commands lead to visible results, SVG allows the definition
of clipping paths. A clipping path is a set of closed vector path that may consist of an arbitrary number
of straight and curved segments. The region(s) enclosed by the path define(s) the visible area, i.e. after
applying a clipping path, only those portions of the subsequently drawn graphics that fall inside the
enclosed area are visible, everything else is cut away. The outline of the clipping paths itself is invisible
of course and only shown in the following examples:</p>

<div class="row align-items-center" style="margin-top:1em;margin-bottom:1em">
   <div class="col-md-6"><img src="../images/clip1.png" class="img-fluid"></div>
   <div class="col-md-6">
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-svg" data-lang="svg"><span style="color:#6272a4">&lt;!-- define triangular clipping path --&gt;</span>
<span style="color:#ff79c6">&lt;clipPath</span> <span style="color:#50fa7b">id=</span><span style="color:#f1fa8c">&#39;clip1&#39;</span><span style="color:#ff79c6">&gt;</span>
  <span style="color:#ff79c6">&lt;path</span> <span style="color:#50fa7b">d=</span><span style="color:#f1fa8c">&#39;M0 0H30V-50Z&#39;</span><span style="color:#ff79c6">/&gt;</span>
<span style="color:#ff79c6">&lt;/clipPath&gt;</span>

<span style="color:#6272a4">&lt;!-- draw clipped circle --&gt;</span>
<span style="color:#ff79c6">&lt;circle</span> <span style="color:#50fa7b">clip-path=</span><span style="color:#f1fa8c">&#34;url(&#39;#clip1&#39;)&#34;</span> <span style="color:#50fa7b">cx=</span><span style="color:#f1fa8c">&#34;35&#34;</span> <span style="color:#50fa7b">cy=</span><span style="color:#f1fa8c">&#34;-35&#34;</span> <span style="color:#50fa7b">r=</span><span style="color:#f1fa8c">&#34;30&#34;</span>
        <span style="color:#50fa7b">fill=</span><span style="color:#f1fa8c">&#34;#8080ff&#34;</span> <span style="color:#50fa7b">stroke=</span><span style="color:#f1fa8c">&#34;#000080&#34;</span><span style="color:#ff79c6">/&gt;</span></code></pre></div>
</div>
</div>


<p>If the triangular clipping path is applied to the blue shape, we get the result on the right.
Most SVG renderers/viewers I tested so far support this kind of clipping so that the result is displayed correctly.</p>

<p>Besides defining the clipping path explicitly as shown above, it’s also possible to tell the SVG renderer to compute
the intersection of two clipping paths and to restrict the subsequent drawing actions to the resulting area.
In the following example, the intersection of the two circular paths leads to a rotated lens-shaped region which
defines the actual clipping path:</p>

<div class="row align-items-center" style="margin-top:1em;margin-bottom:1em">
   <div class="col-md-6"><img src="../images/clip2.png" class="img-fluid"></div>
   <div class="col-md-6">
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-svg" data-lang="svg"><span style="color:#6272a4">&lt;!-- define circular clipping path --&gt;</span>
<span style="color:#ff79c6">&lt;clipPath</span> <span style="color:#50fa7b">id=</span><span style="color:#f1fa8c">&#34;clip1&#34;</span><span style="color:#ff79c6">&gt;</span>
  <span style="color:#ff79c6">&lt;circle</span> <span style="color:#50fa7b">cx=</span><span style="color:#f1fa8c">&#34;25&#34;</span> <span style="color:#50fa7b">cy=</span><span style="color:#f1fa8c">&#34;-25&#34;</span> <span style="color:#50fa7b">r=</span><span style="color:#f1fa8c">&#34;15&#34;</span><span style="color:#ff79c6">/&gt;</span>
<span style="color:#ff79c6">&lt;/clipPath&gt;</span>

<span style="color:#6272a4">&lt;!-- define lens-shaped clipping path by intersecting
</span><span style="color:#6272a4">      the first circle with another one --&gt;</span>
<span style="color:#ff79c6">&lt;clipPath</span> <span style="color:#50fa7b">id=</span><span style="color:#f1fa8c">&#34;clip2&#34;</span> <span style="color:#50fa7b">clip-path=</span><span style="color:#f1fa8c">&#34;url(&#39;#clip1&#39;)&#34;</span><span style="color:#ff79c6">&gt;</span>
  <span style="color:#ff79c6">&lt;circle</span> <span style="color:#50fa7b">cx=</span><span style="color:#f1fa8c">&#34;35&#34;</span> <span style="color:#50fa7b">cy=</span><span style="color:#f1fa8c">&#34;-35&#34;</span> <span style="color:#50fa7b">r=</span><span style="color:#f1fa8c">&#34;15&#34;</span><span style="color:#ff79c6">/&gt;</span>
<span style="color:#ff79c6">&lt;/clipPath&gt;</span></code></pre></div>
</div>
</div>


<p>If we now assign this clipping path to the following blue rectangle, the result should look as follows:</p>

<div class="row align-items-center" style="margin-top:1em;margin-bottom:1em">
   <div class="col-md-6"><img src="../images/clip3.png" class="img-fluid"></div>
   <div class="col-md-6">
<div class="highlight"><pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-svg" data-lang="svg"><span style="color:#6272a4">&lt;!-- define circular clipping path --&gt;</span>
<span style="color:#ff79c6">&lt;clipPath</span> <span style="color:#50fa7b">id=</span><span style="color:#f1fa8c">&#34;clip1&#34;</span><span style="color:#ff79c6">&gt;</span>
  <span style="color:#ff79c6">&lt;circle</span> <span style="color:#50fa7b">cx=</span><span style="color:#f1fa8c">&#34;25&#34;</span> <span style="color:#50fa7b">cy=</span><span style="color:#f1fa8c">&#34;-25&#34;</span> <span style="color:#50fa7b">r=</span><span style="color:#f1fa8c">&#34;15&#34;</span><span style="color:#ff79c6">/&gt;</span>
<span style="color:#ff79c6">&lt;/clipPath&gt;</span>
<span style="color:#6272a4">&lt;!-- define lens-shaped clipping path by intersecting
</span><span style="color:#6272a4">      the first circle with another one --&gt;</span>
<span style="color:#ff79c6">&lt;clipPath</span> <span style="color:#50fa7b">id=</span><span style="color:#f1fa8c">&#34;clip2&#34;</span> <span style="color:#50fa7b">clip-path=</span><span style="color:#f1fa8c">&#34;url(&#39;#clip1&#39;)&#34;</span><span style="color:#ff79c6">&gt;</span>
  <span style="color:#ff79c6">&lt;circle</span> <span style="color:#50fa7b">cx=</span><span style="color:#f1fa8c">&#34;35&#34;</span> <span style="color:#50fa7b">cy=</span><span style="color:#f1fa8c">&#34;-35&#34;</span> <span style="color:#50fa7b">r=</span><span style="color:#f1fa8c">&#34;15&#34;</span><span style="color:#ff79c6">/&gt;</span>
<span style="color:#ff79c6">&lt;/clipPath&gt;</span>
<span style="color:#6272a4">&lt;!-- draw clipped rectangle --&gt;</span>
<span style="color:#ff79c6">&lt;rect</span> <span style="color:#50fa7b">clip-path=</span><span style="color:#f1fa8c">&#34;url(&#39;#clip2&#39;)&#34;</span> <span style="color:#50fa7b">x=</span><span style="color:#f1fa8c">&#34;25&#34;</span> <span style="color:#50fa7b">y=</span><span style="color:#f1fa8c">&#34;-60&#34;</span> <span style="color:#50fa7b">width=</span><span style="color:#f1fa8c">&#34;10&#34;</span>
      <span style="color:#50fa7b">height=</span><span style="color:#f1fa8c">&#34;60&#34;</span> <span style="color:#50fa7b">fill=</span><span style="color:#f1fa8c">&#34;#8080ff&#34;</span> <span style="color:#50fa7b">stroke=</span><span style="color:#f1fa8c">&#34;#000080&#34;</span><span style="color:#ff79c6">/&gt;</span></code></pre></div>
</div>
</div>


<p>Fortunately, the latest releases of most web browsers handle the intersections of clipping paths correctly.
However, some SVG renders/viewers don’t compute them as expected and display wrong results. The following
figure shows the images created by three different applications:</p>

<p><img src="../images/clip4.png" class="img-fluid"></p>

<p>As of version 1.8 <em>dvisvgm</em> provides the command-line option <code>--clipjoin</code> which tells the utility to compute the
shape of intersecting clipping paths directly and not to delegate this task to the SVG renderer. The resulting
SVG files should be more portable.
The following images illustrate the effect of the option in a more complex context created from <a href="http://www.texample.net/tikz/examples/focused-ion-beam-system">this TikZ example</a> and rendered by Inkscape.
Both SVG files were created from the same DVI file, the first one without and the second one with option <code>--clipjoin</code>:</p>

<p><div class="row align-items-center">
  <div class="col-md-6">
  <a href="../images/ion-beam1.svgz"><img src="../images/ion-beam1.png" class="img-fluid"></a></div>

<div class="col-md-6">
  <a href="../images/ion-beam2.svgz"><img src="../images/ion-beam2.png" class="img-fluid"></a></div>
</div>
</p>

</div>
    </main>
    <footer>
      <div class="jumbotron bg-primary text-white" style="padding:20px; border-radius:0">
  <div class="container">
    <i class="fa fa-copyright"></i> 2018 Martin Gieseking •
    <a href="/Contact"><i class="fa fa-envelope"></i> Contact</a> •
    <a href="https://github.com/mgieseki/dvisvgm/issues" target="_blank"><i class="fa fa-bug"></i> Report a Bug</a>
  </div>
</div>
</footer>
    <script src="https://mgieseki.github.io/dvisvgm/js/jquery-3.3.1.slim.min.js"></script>
<script src="https://mgieseki.github.io/dvisvgm/js/popper.min.js"></script>
<script src="https://mgieseki.github.io/dvisvgm/js/bootstrap.min.js"></script>
<script src="https://mgieseki.github.io/dvisvgm/js/ekko-lightbox.min.js"></script>
<script src="https://mgieseki.github.io/dvisvgm/js/site.js"></script>
</body>
</html>
